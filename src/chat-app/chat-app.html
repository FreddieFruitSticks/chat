<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="./page-one.html">
<link rel="import" href="./page-two.html">

<!-- app-layout -->
<link rel="import" href="../../bower_components/app-layout/app-drawer-layout/app-drawer-layout.html">
<link rel="import" href="../../bower_components/app-layout/app-drawer/app-drawer.html">
<link rel="import" href="../../bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../../bower_components/app-layout/app-header-layout/app-header-layout.html">

<!-- paper input -->
<link rel="import" href="../../bower_components/paper-input/paper-input.html">

<!-- Iron -->
<link rel="import" href="../../bower_components/iron-selector/iron-selector.html">
<link rel="import" href="../../bower_components/iron-pages/iron-pages.html">

<!-- Routing -->
<link rel="import" href="../../bower_components/app-route/app-location.html">
<link rel="import" href="../../bower_components/app-route/app-route.html">

<dom-module id="chat-app">
  <template>
    <style>
      :host{
        display:block;
        --app-secondary-color:black;
      }
      .my-drawer {
        background-color: #E7E7E7;
        height:85%;
      }
      .my-topbar {
        background-color: #d91511
      }
      .chat-input {
        position:fixed;
        bottom:40px;
        width:50%;
      }

      .drawer-list a{
        display:block;
        padding: 0 16px;
        color:var(--app-secondary-color);
        line-height:40px;
      }
      .drawer-list a.iron-selected{
        color:black;
        font-weight:bold;
      }

    </style>
    <app-drawer-layout class="my-drawer" fullbleed>

      <app-drawer slot="drawer">
        <app-toolbar>List</app-toolbar>
        <iron-selector class="drawer-list" selected="[[page]]" attr-for-selected="name" role="navigation">
          <a name="page-one" href="/page-one">Page One</a>
          <a name="page-two" href="/page-two">Page Two</a>
        </iron-selector>
      </app-drawer>

      <app-header-layout>
        <app-header>
          <app-toolbar class="my-topbar">
            Chat2
          </app-toolbar>
        </app-header>
      </app-header-layout>

      <paper-input label="Message" class="chat-input">
      </paper-input>
    <app-drawer-layout>

    <!-- app location matches the url on the url bar -->
    <app-location route={{route}}></app-location>

    <!-- route gets ingested as arg and spits out routeData:{page:theroute} -->
    <app-route
      route={{route}}
      pattern="/:page"
      data={{routeData}}>
    <app-route>

    <!-- listen to page in routeData and change the pages accordingly -->
    <iron-pages
        selected="[[routeData.page]]"
        attr-for-selected="name"
        fallback-selection="page-two"
        role="main">
      <page-two name="page-two"></page-two>
      <page-one name="page-one"></page-one>
    </iron-pages>

  </template>

  <script>
    'use strict'
    class ChatApp extends Polymer.Element{
      static get is(){return "chat-app"}
      static get config(){
        return {
          properties:{
            // add observer to page attribute in routeData
            page: {
              type:String,
              reflectToAttribute: true,
              observer: 'pageChanged'
            }
          },
          // create observer that takes in routeData.page
          observers:[
            'routePageChanged(routeData.page)'
          ],
        };
      }
      // change the page value which triggers the observer pageChanged
      routePageChanged(page){
        this.page = page
      }
      // all this to log the page changed, not used in the page transition
      pageChanged(page, oldPage){
        console.log(page)
      }

    }
    customElements.define(ChatApp.is, ChatApp);

  </script>
</dom-module>
